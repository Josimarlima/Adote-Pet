{"ast":null,"code":"import api from'../../../utils/api';import{useState,useEffect}from'react';import{useParams}from'react-router-dom';import styles from'./AddPet.module.css';import PetForm from'../../form/PetForm';/* hooks */import useFlashMessage from'../../../hooks/useFlashMessage';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";function EditPet(){const[pet,setPet]=useState({});const[token]=useState(localStorage.getItem('token')||'');const{id}=useParams();const{setFlashMessage}=useFlashMessage();useEffect(()=>{api.get(\"/pets/\".concat(id),{headers:{Authorization:\"Bearer \".concat(JSON.parse(token))}}).then(response=>{setPet(response.data.pet);});},[token,id]);async function updatePet(pet){let msgType='success';const formData=new FormData();const petFormData=await Object.keys(pet).forEach(key=>{if(key==='images'){for(let i=0;i<pet[key].length;i++){formData.append(\"images\",pet[key][i]);}}else{formData.append(key,pet[key]);}});formData.append('pet',petFormData);const data=await api.patch(\"pets/\".concat(pet._id),formData,{headers:{Authorization:\"Bearer \".concat(JSON.parse(token)),'Content-Type':'multipart/form-data'}}).then(response=>{console.log(response.data);return response.data;}).catch(err=>{console.log(err);msgType='error';return err.response.data;});setFlashMessage(data.message,msgType);}return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.addpet_header,children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Editando o Pet: \",pet.name]}),/*#__PURE__*/_jsx(\"p\",{children:\"Depois da edi\\xE7\\xE3o os dados ser\\xE3o atualizados no sistema\"})]}),pet.name&&/*#__PURE__*/_jsx(PetForm,{handleSubmit:updatePet,petData:pet,btnText:\"Editar\"})]});}export default EditPet;","map":{"version":3,"names":["api","useState","useEffect","useParams","styles","PetForm","useFlashMessage","jsxs","_jsxs","jsx","_jsx","EditPet","pet","setPet","token","localStorage","getItem","id","setFlashMessage","get","concat","headers","Authorization","JSON","parse","then","response","data","updatePet","msgType","formData","FormData","petFormData","Object","keys","forEach","key","i","length","append","patch","_id","console","log","catch","err","message","children","className","addpet_header","name","handleSubmit","petData","btnText"],"sources":["D:/Projetos/Node/15_GETAPET/frontend/src/components/pages/Pet/EditPet.js"],"sourcesContent":["import api from '../../../utils/api'\n\nimport { useState, useEffect } from 'react'\nimport { useParams } from 'react-router-dom'\n\nimport styles from './AddPet.module.css'\n\nimport PetForm from '../../form/PetForm'\n\n/* hooks */\nimport useFlashMessage from '../../../hooks/useFlashMessage'\n\nfunction EditPet() {\n  const [pet, setPet] = useState({})\n  const [token] = useState(localStorage.getItem('token') || '')\n  const { id } = useParams()\n  const { setFlashMessage } = useFlashMessage()\n\n  useEffect(() => {\n    api\n      .get(`/pets/${id}`, {\n        headers: {\n          Authorization: `Bearer ${JSON.parse(token)}`,\n        },\n      })\n      .then((response) => {\n        setPet(response.data.pet)\n      })\n  }, [token, id])\n\n  async function updatePet(pet) {\n    let msgType = 'success'\n\n    const formData = new FormData()\n\n    const petFormData = await Object.keys(pet).forEach((key) => {\n      if (key === 'images') {\n        for (let i = 0; i < pet[key].length; i++) {\n          formData.append(`images`, pet[key][i])\n        }\n      } else {\n        formData.append(key, pet[key])\n      }\n    })\n\n    formData.append('pet', petFormData)\n\n    const data = await api\n      .patch(`pets/${pet._id}`, formData, {\n        headers: {\n          Authorization: `Bearer ${JSON.parse(token)}`,\n          'Content-Type': 'multipart/form-data',\n        },\n      })\n      .then((response) => {\n        console.log(response.data)\n        return response.data\n      })\n      .catch((err) => {\n        console.log(err)\n        msgType = 'error'\n        return err.response.data\n      })\n\n    setFlashMessage(data.message, msgType)\n  }\n\n  return (\n    <section>\n      <div className={styles.addpet_header}>\n        <h1>Editando o Pet: {pet.name}</h1>\n        <p>Depois da edição os dados serão atualizados no sistema</p>\n      </div>\n      {pet.name && (\n        <PetForm handleSubmit={updatePet} petData={pet} btnText=\"Editar\" />\n      )}\n    </section>\n  )\n}\n\nexport default EditPet\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}