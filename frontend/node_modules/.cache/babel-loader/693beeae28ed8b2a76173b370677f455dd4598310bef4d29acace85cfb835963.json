{"ast":null,"code":"import api from'../../../utils/api';import{Link}from'react-router-dom';import{useState,useEffect}from'react';import styles from'./Dashboard.module.css';import RoundedImage from'../../layout/RoundedImage';/* hooks */import useFlashMessage from'../../../hooks/useFlashMessage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function MyPets(){const[pets,setPets]=useState([]);const[token]=useState(localStorage.getItem('token')||'');const{setFlashMessage}=useFlashMessage();useEffect(()=>{api.get('/pets/mypets',{headers:{Authorization:\"Bearer \".concat(JSON.parse(token))}}).then(response=>{setPets(response.data.pets);});},[token]);async function removePet(id){let msgType='success';const data=await api.delete(\"/pets/\".concat(id),{headers:{Authorization:\"Bearer \".concat(JSON.parse(token))}}).then(response=>{const updatedPets=pets.filter(pet=>pet._id!=id);setPets(updatedPets);return response.data;}).catch(err=>{console.log(err);msgType='error';return err.response.data;});setFlashMessage(data.message,msgType);}async function concludeAdoption(id){let msgType='success';const data=await api.patch(\"/pets/conclude/\".concat(id),{headers:{Authorization:\"Bearer \".concat(JSON.parse(token))}}).then(response=>{return response.data;}).catch(err=>{console.log(err);msgType='error';return err.response.data;});setFlashMessage(data.message,msgType);}return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.petslist_header,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Meus Pets Cadastrados\"}),/*#__PURE__*/_jsx(Link,{to:\"/pet/add\",children:\"Cadastrar Pet\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.petslist_container,children:[pets.length>0&&pets.map(pet=>/*#__PURE__*/_jsxs(\"div\",{className:styles.petlist_row,children:[/*#__PURE__*/_jsx(RoundedImage,{src:\"\".concat(process.env.REACT_APP_API,\"/images/pets/\").concat(pet.images[0]),alt:pet.name,width:\"px75\"}),/*#__PURE__*/_jsx(\"span\",{className:\"bold\",children:pet.name}),/*#__PURE__*/_jsx(\"div\",{className:styles.actions,children:pet.available?/*#__PURE__*/_jsxs(_Fragment,{children:[pet.adopter&&/*#__PURE__*/_jsx(\"button\",{className:styles.conclude_btn,onClick:()=>{concludeAdoption(pet._id);},children:\"Concluir ado\\xE7\\xE3o\"}),/*#__PURE__*/_jsx(Link,{to:\"/pet/edit/\".concat(pet._id),children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{removePet(pet._id);},children:\"Excluir\"})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Pet j\\xE1 adotado\"})})]},pet._id)),pets.length===0&&/*#__PURE__*/_jsx(\"p\",{children:\"Ainda n\\xE3o h\\xE1 pets cadastrados!\"})]})]});}export default MyPets;","map":{"version":3,"names":["api","Link","useState","useEffect","styles","RoundedImage","useFlashMessage","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MyPets","pets","setPets","token","localStorage","getItem","setFlashMessage","get","headers","Authorization","concat","JSON","parse","then","response","data","removePet","id","msgType","delete","updatedPets","filter","pet","_id","catch","err","console","log","message","concludeAdoption","patch","children","className","petslist_header","to","petslist_container","length","map","petlist_row","src","process","env","REACT_APP_API","images","alt","name","width","actions","available","adopter","conclude_btn","onClick"],"sources":["D:/Projetos/Node/15_GETAPET/frontend/src/components/pages/Pet/MyPets.js"],"sourcesContent":["import api from '../../../utils/api'\n\nimport { Link } from 'react-router-dom'\nimport { useState, useEffect } from 'react'\n\nimport styles from './Dashboard.module.css'\n\nimport RoundedImage from '../../layout/RoundedImage'\n\n/* hooks */\nimport useFlashMessage from '../../../hooks/useFlashMessage'\n\nfunction MyPets() {\n  const [pets, setPets] = useState([])\n  const [token] = useState(localStorage.getItem('token') || '')\n  const { setFlashMessage } = useFlashMessage()\n\n  useEffect(() => {\n    api\n      .get('/pets/mypets', {\n        headers: {\n          Authorization: `Bearer ${JSON.parse(token)}`,\n        },\n      })\n      .then((response) => {\n        setPets(response.data.pets)\n      })\n  }, [token])\n\n  async function removePet(id) {\n    let msgType = 'success'\n\n    const data = await api\n      .delete(`/pets/${id}`, {\n        headers: {\n          Authorization: `Bearer ${JSON.parse(token)}`,\n        },\n      })\n      .then((response) => {\n        const updatedPets = pets.filter((pet) => pet._id != id)\n        setPets(updatedPets)\n        return response.data\n      })\n      .catch((err) => {\n        console.log(err)\n        msgType = 'error'\n        return err.response.data\n      })\n\n    setFlashMessage(data.message, msgType)\n  }\n\n  async function concludeAdoption(id) {\n    let msgType = 'success'\n\n    const data = await api\n      .patch(`/pets/conclude/${id}`, {\n        headers: {\n          Authorization: `Bearer ${JSON.parse(token)}`,\n        },\n      })\n      .then((response) => {\n        return response.data\n      })\n      .catch((err) => {\n        console.log(err)\n        msgType = 'error'\n        return err.response.data\n      })\n\n    setFlashMessage(data.message, msgType)\n  }\n\n  return (\n    <section>\n      <div className={styles.petslist_header}>\n        <h1>Meus Pets Cadastrados</h1>\n        <Link to=\"/pet/add\">Cadastrar Pet</Link>\n      </div>\n      <div className={styles.petslist_container}>\n        {pets.length > 0 &&\n          pets.map((pet) => (\n            <div key={pet._id} className={styles.petlist_row}>\n              <RoundedImage\n                src={`${process.env.REACT_APP_API}/images/pets/${pet.images[0]}`}\n                alt={pet.name}\n                width=\"px75\"\n              />\n              <span className=\"bold\">{pet.name}</span>\n              <div className={styles.actions}>\n                {pet.available ? (\n                  <>\n                    {pet.adopter && (\n                      <button\n                        className={styles.conclude_btn}\n                        onClick={() => {\n                          concludeAdoption(pet._id)\n                        }}\n                      >\n                        Concluir adoção\n                      </button>\n                    )}\n\n                    <Link to={`/pet/edit/${pet._id}`}>Editar</Link>\n                    <button\n                      onClick={() => {\n                        removePet(pet._id)\n                      }}\n                    >\n                      Excluir\n                    </button>\n                  </>\n                ) : (\n                  <p>Pet já adotado</p>\n                )}\n              </div>\n            </div>\n          ))}\n        {pets.length === 0 && <p>Ainda não há pets cadastrados!</p>}\n      </div>\n    </section>\n  )\n}\n\nexport default MyPets\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}